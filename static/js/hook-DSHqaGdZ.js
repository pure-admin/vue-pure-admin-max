var k=(l,c,s)=>new Promise((u,f)=>{var p=t=>{try{m(s.next(t))}catch(i){f(i)}},r=t=>{try{m(s.throw(t))}catch(i){f(i)}},m=t=>t.done?u(t.value):Promise.resolve(t.value).then(p,r);m((s=s.apply(l,c)).next())});import{r as C,a as o,m as F,g as O,a_ as j,b0 as H,f1 as x,H as R,aj as z,J as N,X as P,ai as J,b as V}from"./index-1Xgc0oTd.js";import{_ as X}from"./form.vue_vue_type_script_setup_true_lang-H_oNVf23.js";import{e as q}from"./system-BMoT8QdR.js";import{u as A}from"./hooks-CWx24tZb.js";import"./index-qkJ7E3n1.js";function E(){const l=C({name:"",status:null}),c=o(),s=o([]),u=o(!0),{tagStyle:f}=A(),p=[{label:"部门名称",prop:"name",width:180,align:"left"},{label:"排序",prop:"sort",minWidth:70},{label:"状态",prop:"status",minWidth:100,cellRenderer:({row:a,props:e})=>O(V("el-tag"),{size:e.size,style:f.value(a.status)},{default:()=>[a.status===1?"启用":"停用"]})},{label:"创建时间",minWidth:200,prop:"createTime",formatter:({createTime:a})=>j(a).format("YYYY-MM-DD HH:mm:ss")},{label:"备注",prop:"remark",minWidth:320},{label:"操作",fixed:"right",width:210,slot:"operation"}];function r(a){}function m(a){a&&(a.resetFields(),t())}function t(){return k(this,null,function*(){u.value=!0;const{data:a}=yield q();let e=a;H(l.name)||(e=e.filter(n=>n.name.includes(l.name))),H(l.status)||(e=e.filter(n=>n.status===l.status)),s.value=x(e),setTimeout(()=>{u.value=!1},500)})}function i(a){if(!a||!a.length)return;const e=[];for(let n=0;n<a.length;n++)a[n].disabled=a[n].status===0,i(a[n].children),e.push(a[n]);return e}function M(a="新增",e){var n,d,h,g,b,D,v,y;z({title:`${a}部门`,props:{formInline:{higherDeptOptions:i(J(s.value)),parentId:(n=e==null?void 0:e.parentId)!=null?n:0,name:(d=e==null?void 0:e.name)!=null?d:"",principal:(h=e==null?void 0:e.principal)!=null?h:"",phone:(g=e==null?void 0:e.phone)!=null?g:"",email:(b=e==null?void 0:e.email)!=null?b:"",sort:(D=e==null?void 0:e.sort)!=null?D:0,status:(v=e==null?void 0:e.status)!=null?v:1,remark:(y=e==null?void 0:e.remark)!=null?y:""}},width:"40%",draggable:!0,fullscreen:P(),fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>N(X,{ref:c,formInline:null}),beforeSure:(T,{options:W})=>{const Y=c.value.getRef(),_=W.props.formInline;function I(){R(`您${a}了部门名称为${_.name}的这条数据`,{type:"success"}),T(),t()}Y.validate($=>{$&&I()})}})}function S(a){R(`您删除了部门名称为${a.name}的这条数据`,{type:"success"}),t()}return F(()=>{t()}),{form:l,loading:u,columns:p,dataList:s,onSearch:t,resetForm:m,openDialog:M,handleDelete:S,handleSelectionChange:r}}export{E as useDept};
